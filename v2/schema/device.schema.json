{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "v2/schema/device.schema.json",
  "title": "Device",
  "description": "Device configuration for the UBports Installer",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "The human-readable name under which the device was marketed. This includes the name of the manufacturer if it makes sense. I.e. you would not refer to the 'Oneplus One' as 'One', but you would not call the 'iPhone 9' 'Apple iPhone 9'. Use common sense."
    },
    "codename": {
      "type": "string",
      "description": "A short codename that is used internally to identify the device. This (with the extension '.yml') should also be the filename. If there are multiple codenames in use for the exact same device, only create a single one with the most prominent one and add the correct aliases to aliases.json."
    },
    "formfactor": {
      "$ref": "formfactor.schema.json#"
    },
    "aliases": {
      "type": "array",
      "description": "Alternative codenames this device might be identified as.",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "doppelgangers": {
      "type": "array",
      "description": "Codenames of devices this device should not be confused with.",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "$schema": {
      "type": "string",
      "description": "JSON-schema url"
    },
    "user_actions": {
      "$ref": "user_actions.schema.json#"
    },
    "unlock": {
      "type": "array",
      "description": "An array of strings referring to user_actions defined above that are needed to unlock the device. This might include simple things like enabling adb access or bigger steps like using a leaked oem tool to flash highly questionable images that unlock the bootloader. Whatever is needed to make installations possible.",
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "operating_systems": {
      "type": "array",
      "description": "An array of objects describing operating systems available for installation.",
      "uniqueItems": true,
      "items": {
        "type": "object",
        "description": "An operating system available for installation",
        "properties": {
          "name": {
            "type": "string",
            "description": "Human-readable name of the operating system."
          },
          "options": {
            "type": "array",
            "description": "Options for the installation.",
            "items": {
              "type": "object",
              "description": "Option for the installation.",
              "properties": {
                "var": {
                  "type": "string",
                  "description": "Variable the setting will be stored in."
                },
                "name": {
                  "type": "string",
                  "description": "Human-readable identifier of the setting."
                },
                "tooltip": {
                  "type": "string",
                  "description": "A very short help text describing the setting."
                },
                "link": {
                  "type": "string",
                  "description": "A link to the docs describing the setting."
                },
                "type": {
                  "type": "string",
                  "description": "Describes what values are accepted by the setting and how they are provided.",
                  "enum": [
                    "checkbox",
                    "input",
                    "select"
                  ]
                },
                "remote_values": {
                  "type": "object",
                  "description": "If the values can be generated from a remote source like the systemimage api, this provides the required information for that.",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["systemimagechannels"]
                    }
                  }
                },
                "value": {
                  "description": "Default value of the option"
                },
                "values": {
                  "type": "array",
                  "description": "List of values for the select."
                }
              },
              "required": [
                "var",
                "name",
                "type"
              ]
            }
          },
          "prerequisites": {
            "type": "array",
            "description": "An array of strings referring to user_actions defined above that are needed before the installation. This should not include the steps from the generic unlock block, but actions specific to the installation of this operating system.",
            "values": {
              "type": "string",
              "description": "Reference to user_action that's needed before the installation of this OS. Steps required for every OS should be put in the generic unlock block instead."
            }
          },
          "steps": {
            "type": "array",
            "description": "An ordered array of objects describing steps required to install the operating system.",
            "items": {
              "$ref": "step.schema.json#"
            }
          },
          "slideshow": {
            "type": "array",
            "description": "An array of slides presenting the operating system's most compelling features.",
            "items": {
              "type": "object",
              "description": "Slide about the operating system",
              "properties": {
                "title": {
                  "type": "string",
                  "description": "Title of the slide"
                },
                "text": {
                  "type": "string",
                  "description": "Text body of the slide, Markdown supported here."
                },
                "image": {
                  "type": "string",
                  "description": "Image displayed on the slide."
                }
              }
            }
          },
          "video": {
            "type": "string",
            "description": "A video introducing the user to the operating system they just installed."
          },
          "donate": {
            "type": "string",
            "description": "A link to donate to the developer of the operating system."
          },
          "get_involved": {
            "type": "string",
            "description": "A link to the OSs get involved page."
          }
        }
      }
    }
  },
  "required": [
    "name",
    "codename",
    "operating_systems",
    "formfactor"
  ],
  "additionalProperties": false
}
